set -x

# Find available port to run server on
port=$(find_port ${host})

# Create ~/.singularity as symlink to work.
if [[ ! -e ~/.singularity ]]; then
    mkdir -p ~/work/.singularity
    ln -sr ~/work/.singularity ~/.singularity
fi

export RSTUDIO_SERVER_IMAGE=shub://nickjer/singularity-rstudio
export RSTUDIO_SERVER_IMAGE=/fast/users/holtgrem_c/.singularity/cache/shub/d261002009b55218923d523e9b71c70ea5edd4d3/singularity-rstudio_latest.sif

# Pull singularity image.
singularity pull $RSTUDIO_SERVER_IMAGE

# Define a password and export it for RStudio authentication
password="$(create_passwd 16)"
export RSTUDIO_PASSWORD="${password}"
